<!DOCTYPE html>
<html lang="en">
<head>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="/tradelist/styles/global.css">
    <meta charset="UTF-8">
    <title>Untitled</title>
</head>
<body>
  <header class="navbar">
    <div><strong>Vortex Trade List</strong></div>
    <nav>
	  <a href="/tradelist/">Home</a>
	  <a href="/tradelist/shows/">Browse Shows</a>
	  <a href="/tradelist/updates/">Updates</a>
    </nav>
  </header>

  <main>
    
<div class="table-wrapper" style="margin-top: 5px;">
  <table>
    <thead>
      <tr>
        <th>Band</th>
        <th>Date</th>
        <th>City</th>
        <th>State</th>
        <th>Country</th>
        <th>Event</th>
        <th>Show</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          
            Children Of Bodom
          
        </td>
        <td>
          
            2014-07-04
          
        </td>
        <td>Turku</td>
        <td>—</td>
        <td>Finland</td>
        <td>Ruisrock Festival</td>
        <td>—</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="table-wrapper" style="margin-top: 10px;">
  <table>
    <thead>
      <tr>
        <th>Details</th>
        <th>Images</th>
        <th>Setlist</th>
      </tr>
    </thead>
    <tbody>
      <tr>
      <td>
      <!-- DETAILS -->
      <div style="display: table-cell; padding: 10px;">
        <p><strong>TV Channel:</strong> </p>
        <p><strong>Source:</strong> </p>
        <p><strong>Length:</strong> 00:45:51</p>
        <p><strong>Media:</strong>
          
            DVD-5 (1.33Gb)
          
        </p>
        <p><strong>Video:</strong>
          
            
             720x576 16:9 PAL, fps
          
        </p>
        <p><strong>Audio:</strong>
          
            
            MPEG1 2ch @ Hz
          
        </p>
        <p><strong>Recording Type:</strong> PRO</p>
        <p><strong>Source Media:</strong> </p>
        <p><strong>Final Format:</strong> </p>
        <p><strong>File Format:</strong> DVD</p>
        <p><strong>Taper(s):</strong> </p>
        <p><strong>Trade Label:</strong> </p>
        <p><strong>Master Copy:</strong>
          No
        </p>
        <p><strong>Authored By:</strong> </p>
        <p><strong>Transferred By:</strong> </p>
      </td>

      <!-- IMAGES -->
      <td>
        
          
            <img src="https://drive.google.com/thumbnail?id=1fN532pWmdaMmto5WwYEusWvS_fZ-BcNp&sz=w192"
                 alt="thumb"
                 width="192"
                 height="132"
                 style="display: flex; flex-direction: column; gap: 10px;"
                 onclick='openModal("1fN532pWmdaMmto5WwYEusWvS_fZ-BcNp", [{"folder":"71","filename":"09488727.jpg","externalId":"1fN532pWmdaMmto5WwYEusWvS_fZ-BcNp"},{"folder":"71","filename":"29963802.jpg","externalId":"137IrDAvhDV6zxsm72wUzPpcV5Hv3NNMR"},{"folder":"71","filename":"46690280.jpg","externalId":"1-1UmEH-IRFU7mS0odTOmxVecJ8LVD_n4"},{"folder":"71","filename":"08743352.jpg","externalId":"1fZw7tuKjTxzcW4fQVzn9nqXDlQWPTFSG"}])'>
          
            <img src="https://drive.google.com/thumbnail?id=137IrDAvhDV6zxsm72wUzPpcV5Hv3NNMR&sz=w192"
                 alt="thumb"
                 width="192"
                 height="132"
                 style="display: flex; flex-direction: column; gap: 10px;"
                 onclick='openModal("137IrDAvhDV6zxsm72wUzPpcV5Hv3NNMR", [{"folder":"71","filename":"09488727.jpg","externalId":"1fN532pWmdaMmto5WwYEusWvS_fZ-BcNp"},{"folder":"71","filename":"29963802.jpg","externalId":"137IrDAvhDV6zxsm72wUzPpcV5Hv3NNMR"},{"folder":"71","filename":"46690280.jpg","externalId":"1-1UmEH-IRFU7mS0odTOmxVecJ8LVD_n4"},{"folder":"71","filename":"08743352.jpg","externalId":"1fZw7tuKjTxzcW4fQVzn9nqXDlQWPTFSG"}])'>
          
            <img src="https://drive.google.com/thumbnail?id=1-1UmEH-IRFU7mS0odTOmxVecJ8LVD_n4&sz=w192"
                 alt="thumb"
                 width="192"
                 height="132"
                 style="display: flex; flex-direction: column; gap: 10px;"
                 onclick='openModal("1-1UmEH-IRFU7mS0odTOmxVecJ8LVD_n4", [{"folder":"71","filename":"09488727.jpg","externalId":"1fN532pWmdaMmto5WwYEusWvS_fZ-BcNp"},{"folder":"71","filename":"29963802.jpg","externalId":"137IrDAvhDV6zxsm72wUzPpcV5Hv3NNMR"},{"folder":"71","filename":"46690280.jpg","externalId":"1-1UmEH-IRFU7mS0odTOmxVecJ8LVD_n4"},{"folder":"71","filename":"08743352.jpg","externalId":"1fZw7tuKjTxzcW4fQVzn9nqXDlQWPTFSG"}])'>
          
            <img src="https://drive.google.com/thumbnail?id=1fZw7tuKjTxzcW4fQVzn9nqXDlQWPTFSG&sz=w192"
                 alt="thumb"
                 width="192"
                 height="132"
                 style="display: flex; flex-direction: column; gap: 10px;"
                 onclick='openModal("1fZw7tuKjTxzcW4fQVzn9nqXDlQWPTFSG", [{"folder":"71","filename":"09488727.jpg","externalId":"1fN532pWmdaMmto5WwYEusWvS_fZ-BcNp"},{"folder":"71","filename":"29963802.jpg","externalId":"137IrDAvhDV6zxsm72wUzPpcV5Hv3NNMR"},{"folder":"71","filename":"46690280.jpg","externalId":"1-1UmEH-IRFU7mS0odTOmxVecJ8LVD_n4"},{"folder":"71","filename":"08743352.jpg","externalId":"1fZw7tuKjTxzcW4fQVzn9nqXDlQWPTFSG"}])'>
          
        
      </td>

      <!-- SETLIST -->
      <td>
        
          <ol>
            
              <li>
                Hate Me!
                
                
                
              </li>
            
              <li>
                Bodom Beach Terror
                
                
                
              </li>
            
              <li>
                Scream For Silence
                
                
                
              </li>
            
              <li>
                In Your Face
                
                
                
              </li>
            
              <li>
                Angels Don&#39;t Kill
                
                
                
              </li>
            
              <li>
                Interview
                
                
                
              </li>
            
              <li>
                Lake Bodom
                
                
                
              </li>
            
              <li>
                Downfall
                
                
                
              </li>
            
              <li>
                Hate Crew Deathroll
                
                
                
              </li>
            
          </ol>
        
      </td>
      </tr>
    </tbody>
  </table>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var thumbs = document.querySelectorAll('.image-thumb');
  var modal = document.getElementById('imageModal');
  var modalIframe = document.getElementById('driveViewer');
  var captionText = document.getElementById('caption');
  var closeBtn = document.querySelector('#imageModal .close');
  var nextBtn = document.querySelector('#imageModal .next');
  var prevBtn = document.querySelector('#imageModal .prev');
  var currentIndex = 0;

  thumbs.forEach(function(thumb, idx) {
    thumb.addEventListener('click', function(e) {
      e.preventDefault();
      currentIndex = idx;
      var id = thumb.getAttribute('data-drive-id');
      modal.style.display = 'flex';
      modalIframe.src = 'https://drive.google.com/file/d/' + id + '/preview';
      captionText.textContent = thumb.querySelector('img').alt || '';
    });
  });

  closeBtn.addEventListener('click', function() {
    modal.style.display = 'none';
    modalIframe.src = '';
  });

  nextBtn.addEventListener('click', function() {
    currentIndex = (currentIndex + 1) % thumbs.length;
    thumbs[currentIndex].click();
  });

  prevBtn.addEventListener('click', function() {
    currentIndex = (currentIndex - 1 + thumbs.length) % thumbs.length;
    thumbs[currentIndex].click();
  });

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      modal.style.display = 'none';
      modalIframe.src = '';
    }
  });
});
</script>
<!-- Modal for image preview -->
<div id="imageModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background-color:rgba(0,0,0,0.7); z-index:1000; align-items:center; justify-content:center;">
  <div style="position:relative; width:90%; height:90%;">
    <span onclick="closeModal()" style="position:absolute; top:11px; right:60px; font-size:2rem; color:white; background-color:rgba(0,0,0,0.6); padding:1px 10px; border-radius:4px; cursor:pointer;">×</span>
	<button id="modalPrev" style="position:absolute; left:10px; top:50%; transform:translateY(-50%); font-size:2rem; background:rgba(0,0,0,0.6); color:white; border:none; padding:8px 12px; cursor:pointer;">←</button>
	<button id="modalNext" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); font-size:2rem; background:rgba(0,0,0,0.6); color:white; border:none; padding:8px 12px; cursor:pointer;">→</button>
    <iframe id="modalImage" style="width:100%; height:100%; border:none; border-radius:0px;"></iframe>
  </div>
</div>

<script>
  let currentImages = [];
  let currentIndex = 0;

  function openModal(id, images = []) {
    currentImages = images;
    currentIndex = images.findIndex(img => img.externalId === id);
    showImageAt(currentIndex);
    document.getElementById('imageModal').style.display = 'flex';
  }

  function showImageAt(index) {
  const img = currentImages[index];
  if (!img) return;
  
  const iframe = document.getElementById('modalImage');
  iframe.src = `https://drive.google.com/file/d/${img.externalId}/preview`;
  
  // Show/hide arrows
  document.getElementById('modalPrev').style.display = index > 0 ? 'block' : 'none';
  document.getElementById('modalNext').style.display = index < currentImages.length - 1 ? 'block' : 'none';
  }

  function closeModal() {
    document.getElementById('imageModal').style.display = 'none';
    document.getElementById('modalImage').src = '';
    currentImages = [];
    currentIndex = 0;
  }

  function nextImage() {
    if (currentIndex < currentImages.length - 1) {
      currentIndex++;
      showImageAt(currentIndex);
    }
  }

  function prevImage() {
    if (currentIndex > 0) {
      currentIndex--;
      showImageAt(currentIndex);
    }
  }
  
  function updateShowCount() {
    const allRows = [...document.querySelectorAll('#shows-table tbody tr')];
    const visibleShows = allRows.filter(row =>
      row.style.display !== 'none' &&
      !row.classList.contains('year-label-row') &&
      !row.classList.contains('band-label-row') &&
      !row.classList.contains('category-label-row')
    );
    document.getElementById('show-count').textContent = `Shows: ${visibleShows.length}`;
  }
  
function insertGroupLabels() {
  const tbody = document.querySelector('#shows-table tbody');
  const rows = [...tbody.querySelectorAll('tr')];
  const visible = rows.filter(r => r.style.display !== 'none' && !r.hasAttribute('data-label'));

  // Remove existing label rows
  rows.forEach(r => r.hasAttribute('data-label') && r.remove());

  if (!selectedBand) {
    // Group by band (default)
    let currentBand = null;
    for (const row of visible) {
      const band = row.dataset.band || '—';
      if (band !== currentBand) {
        currentBand = band;
        const label = document.createElement('tr');
        label.className = 'band-label-row';
        label.setAttribute('data-label', 'true');
        label.innerHTML = `<td colspan="11" class="band-label">🎸 ${band}</td>`;
        tbody.insertBefore(label, row);
      }
    }
    return;
  }

  // When band is selected
  const CATEGORY_ORDER = {
    'video': 1,
    'video_misc': 2,
    'video_compilation': 3,
    'audio': 4,
    'audio_misc': 5
  };

  const groups = {};  // { 'video': { year: [rows] } }

  for (const row of visible) {
    const raw = row.dataset.json;
    if (!raw) continue;

    let show;
    try {
      show = JSON.parse(decodeURIComponent(raw));
    } catch (e) {
      continue;
    }

  const catArr = show.category || [];
  let catKey = '';
  
  if (Array.isArray(catArr)) {
    const set = new Set(catArr);
  
    if (set.has('video') && set.size === 1) {
      catKey = 'video';
    } else if ((set.has('video') && set.has('misc')) || (set.has('misc') && set.size === 1)) {
      catKey = 'video_misc';
    } else if ((set.has('video') && set.has('compilation')) || (set.has('compilation') && set.size === 1)) {
      catKey = 'video_compilation';
    } else if (set.has('audio') && set.size === 1) {
      catKey = 'audio';
    } else if (set.has('audio') && set.has('misc')) {
      catKey = 'audio_misc';
    } else {
      catKey = 'other';
    }
  }

    const year = show.startDateUnix
      ? new Date(show.startDateUnix * 1000).getFullYear().toString()
      : '—';

    if (!groups[catKey]) groups[catKey] = {};
    if (!groups[catKey][year]) groups[catKey][year] = [];
    groups[catKey][year].push(row);
  }

  const emojiFor = {
    video: '🎥 Video',
    video_misc: '🎥 Misc',
    video_compilation: '🎥 Compilation',
    audio: '🔊 Audio',
    audio_misc: '🔊 Audio Misc',
    other: '❓ Other'
  };

  const orderedKeys = Object.keys(CATEGORY_ORDER)
    .concat('other')
    .filter(k => groups[k]);

  for (const key of orderedKeys) {
    const catGroup = groups[key];
    if (!catGroup) continue;

    const catLabelRow = document.createElement('tr');
    catLabelRow.setAttribute('data-label', 'true');
	catLabelRow.className = 'category-label-row';
	catLabelRow.innerHTML = `<td colspan="11" class="category-label">${emojiFor[key]}</td>`;
    tbody.appendChild(catLabelRow);

    const sortedYears = Object.keys(catGroup).sort((a, b) => a.localeCompare(b));

    for (const year of sortedYears) {
      const yearLabelRow = document.createElement('tr');
      yearLabelRow.setAttribute('data-label', 'true');
      yearLabelRow.className = 'year-label-row';
      yearLabelRow.innerHTML = `<td colspan="11" class="year-label">📅 ${year}</td>`;
      tbody.appendChild(yearLabelRow);

      for (const row of catGroup[year]) {
        tbody.appendChild(row);
      }
    }
  }
}


  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeModal();
    if (e.key === 'ArrowRight') nextImage();
    if (e.key === 'ArrowLeft') prevImage();
  });

  document.getElementById('modalNext').onclick = nextImage;
  document.getElementById('modalPrev').onclick = prevImage;
  document.addEventListener('DOMContentLoaded', () => {
});
document.addEventListener("click", function (e) {
  if (e.target.matches(".toggle-media")) {
    e.preventDefault();
    const targetId = e.target.dataset.target;
    const block = document.getElementById(targetId);
    if (!block) return;

    const isVisible = block.style.display === "block";
    block.style.display = isVisible ? "none" : "block";
    e.target.innerHTML = isVisible
      ? `▾ +${block.children.length}`
      : `▴`;
  }
});

</script>


  </main>

  <footer style="padding: 2rem; text-align: center; font-size: 0.85rem; color: #888;">
   Vortex © 2025
  </footer>
</body>
</html>